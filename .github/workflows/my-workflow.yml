#Testing-42
name: Run Update

on:
  push:
    branches:
      - pullcode

jobs:
  build:
    name: Run update code
    runs-on: ubuntu-latest
    steps:
      - name: Checkout remote main branch
        uses: actions/checkout@v2
        with:
          repository: leethomasrh/cop-bazaar
          ref: dispatch
          path: ./cop-bazaar
          
      - name: Checkout cop repository
        uses: actions/checkout@v2
        with: 
          path: ./cop
    
      - name: Set up Python 3.x
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'
      - name: Install requests module
        run: pip install requests
      - name: Install yaml module
        run: pip install pyyaml
      - name: setup Github environment
        run: |
          #setup username and email to use Github Actions Bot with no default email
          git config --global user.name "Github Actions Bot"
          git config --global user.email "<>"
      - name: Run COP update
        shell: bash
        run: |
          python ./cop-bazaar/cop_bazaar.py
